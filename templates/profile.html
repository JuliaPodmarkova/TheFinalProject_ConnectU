<!-- templates/profile.html -->
{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container mt-5">
    <div class="row">
        <div class="col-md-4">
            <!-- –ì–ª–∞–≤–Ω–æ–µ —Ñ–æ—Ç–æ -->
            <!-- –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï 1: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–± –ø–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–≤–æ–µ —Ñ–æ—Ç–æ -->
            {% with main_photo=profile_user.photos.all.first %}
                {% if main_photo %}
                    <img src="{{ main_photo.image.url }}" class="img-fluid rounded shadow-sm" alt="–§–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è {{ profile_user.profile.full_name }}">
                {% else %}
                    <img src="{% static 'images/placeholder.png' %}" class="img-fluid rounded shadow-sm" alt="–ù–µ—Ç —Ñ–æ—Ç–æ">
                {% endif %}
            {% endwith %}

            <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
            <div class="d-grid gap-2 mt-3">
                {% if is_own_profile %}
                    <!-- –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï 2: –ó–∞–º–µ–Ω—è–µ–º # –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ URL -->
                    <a href="{% url 'profile_edit' %}" class="btn btn-primary">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</a>
                    <a href="{% url 'settings' %}" class="btn btn-secondary">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</a>
                {% else %}
                    <!-- –≠—Ç–∏ –∫–Ω–æ–ø–∫–∏ –ø–æ–∫–∞ –æ—Å—Ç–∞–≤–∏–º –∫–∞–∫ –∑–∞–≥–ª—É—à–∫–∏ -->
                    <button class="btn btn-success">‚ù§Ô∏è –õ–∞–π–∫</button>
                    <button class="btn btn-danger">üëé –î–∏–∑–ª–∞–π–∫</button>
                    <button class="btn btn-info">üí¨ –ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ</button>
                {% endif %}
            </div>
        </div>

        <div class="col-md-8">
            <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
            <div class="card shadow-sm">
                <div class="card-body">
                    <!-- –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï 3: –ò—Å–ø–æ–ª—å–∑—É–µ–º –º–µ—Ç–æ–¥ get_age –∏–∑ –ø—Ä–æ—Ñ–∏–ª—è -->
                    <h2 class="card-title">{{ profile_user.profile.full_name }}, {{ profile_user.profile.get_age }}</h2>
                    <h5 class="card-subtitle mb-2 text-muted">{{ profile_user.profile.city|default:"–ì–æ—Ä–æ–¥ –Ω–µ —É–∫–∞–∑–∞–Ω" }}</h5>
                    <p class="badge bg-success fs-6">{{ profile_user.profile.get_status_display }}</p>

                    <hr>

                    <h4>–£–≤–ª–µ—á–µ–Ω–∏—è:</h4>
                    <p>{{ profile_user.profile.hobbies|default:"–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –Ω–µ —É–∫–∞–∑–∞–Ω–∞" }}</p>

                    <hr>

                    <div class="d-flex justify-content-start">
                        <div class="me-4">
                            <span class="fs-4">‚ù§Ô∏è {{ profile_user.profile.likes_count }}</span>
                            <small class="text-muted d-block">–õ–∞–π–∫–æ–≤</small>
                        </div>
                        <div>
                            <span class="fs-4">üì∑ {{ profile_user.photos.count }}</span>
                            <small class="text-muted d-block">–§–æ—Ç–æ</small>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ì–∞–ª–µ—Ä–µ—è -->
            <h3 class="mt-4">–§–æ—Ç–æ–≥–∞–ª–µ—Ä–µ—è</h3>
            <hr>
            <div class="row row-cols-2 row-cols-lg-4 g-3">
                {% for photo in profile_user.photos.all %}
                <div class="col">
                    <a href="{{ photo.image.url }}" data-bs-toggle="modal" data-bs-target="#photoModal-{{ photo.id }}">
                        <img src="{{ photo.image.url }}" class="img-fluid rounded" alt="–§–æ—Ç–æ">
                    </a>
                </div>
                {% empty %}
                <div class="col-12">
                    <p>–£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ–∫–∞ –Ω–µ—Ç —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π.</p>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ñ–æ—Ç–æ -->
{% for photo in profile_user.photos.all %}
<div class="modal fade" id="photoModal-{{ photo.id }}" tabindex="-1" aria-labelledby="photoModalLabel-{{ photo.id }}" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="photoModalLabel-{{ photo.id }}">{{ profile_user.profile.full_name }}</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body text-center">
            <img src="{{ photo.image.url }}" class="img-fluid" alt="–§–æ—Ç–æ">
        </div>
    </div>
  </div>
</div>
{% endfor %}
{% endblock %}